# 实施计划：Terminal Portfolio Deployment

## 概述

本实施计划将创建一个 Python 脚本来生成黑客终端风格个人网站的部署配置文件（docker-compose.yml 和 config.json），并提供完整的部署指南文档。所有生成的文件将可以直接用于在阿里云服务器上部署 m4tt72/terminal 项目。

## 任务

- [ ] 1. 创建项目结构和配置生成器核心模块
  - 创建 `generator.py` 作为主要的配置生成脚本
  - 定义数据类或字典结构来存储个人信息和配置参数
  - 实现 YAML 和 JSON 序列化函数
  - _需求: 1.1, 1.2, 1.3, 1.4, 2.1, 2.2, 2.3_

- [ ]* 1.1 为配置生成器编写属性测试
  - **属性 1: Docker Compose 配置完整性**
  - **属性 2: YAML 格式有效性**
  - **属性 3: 终端提示符配置正确性**
  - **验证需求: 1.1, 1.2, 1.3, 1.4, 1.5, 2.1**

- [ ] 2. 实现 Docker Compose 配置生成
  - [ ] 2.1 创建 `generate_docker_compose()` 函数
    - 生成包含 m4tt72/terminal 镜像的服务定义
    - 配置端口映射 3000:3000
    - 配置 config.json 卷挂载（使用相对路径 ./config.json）
    - 设置 restart 策略为 unless-stopped
    - 返回 YAML 格式的字符串
    - _需求: 1.1, 1.2, 1.3, 1.4, 5.4, 7.1_

  - [ ]* 2.2 为 Docker Compose 生成编写单元测试
    - 测试生成的 YAML 包含正确的镜像名称
    - 测试端口映射配置正确
    - 测试卷挂载路径正确
    - 测试重启策略设置正确
    - _需求: 1.1, 1.2, 1.3, 1.4_

- [ ] 3. 实现终端配置文件生成
  - [ ] 3.1 创建 `generate_config_json()` 函数
    - 设置 ps1_username 为 "root"，ps1_hostname 为 "WangJian"
    - 生成包含个人信息的 bioTextLines 数组（年龄、角色、目标、技术热情）
    - 添加 social 对象（github 和 email 占位符）
    - 返回 JSON 格式的字符串
    - _需求: 2.1, 2.2, 2.3, 4.1, 4.2, 4.3_

  - [ ]* 3.2 为配置文件基本信息编写属性测试
    - **属性 4: 个人简介内容完整性**
    - **属性 5: 社交链接字段存在性**
    - **验证需求: 2.2, 2.3, 4.1, 4.2, 4.3**

- [ ] 4. 实现自定义命令生成
  - [ ] 4.1 创建 `create_skills_command()` 函数
    - 生成 skills 命令定义
    - 输出包含五项技能：Linux, Docker, Nginx, Python, Traffic Analysis
    - 使用换行符格式化输出为列表
    - _需求: 2.4, 4.4, 8.1, 8.4_

  - [ ] 4.2 创建 `create_projects_command()` 函数
    - 生成 projects 命令定义
    - 输出包含 Qinglong Auto-Watchdog 项目名称和描述
    - 描述中说明核心功能（修复内存泄漏）
    - 使用换行符格式化输出
    - _需求: 2.5, 4.5, 8.2, 8.4_

  - [ ] 4.3 创建 `create_services_command()` 函数
    - 生成 services 命令定义
    - 输出包含三项服务：Server Rescue (CPU/OOM fix), Script Setup, Environment Deployment
    - 使用换行符格式化输出为列表
    - _需求: 2.6, 4.6, 8.3, 8.4_

  - [ ] 4.4 将所有命令集成到 `generate_config_json()` 函数中
    - 调用三个命令创建函数
    - 将命令添加到 config.json 的 commands 数组
    - _需求: 2.4, 2.5, 2.6_

  - [ ]* 4.5 为自定义命令编写属性测试
    - **属性 6: Skills 命令完整性**
    - **属性 7: Projects 命令完整性**
    - **属性 8: Services 命令完整性**
    - **属性 11: 输出格式可读性**
    - **验证需求: 2.4, 2.5, 2.6, 4.4, 4.5, 4.6, 8.1, 8.2, 8.3, 8.4**

- [ ] 5. 实现文件写入功能
  - [ ] 5.1 创建 `write_docker_compose()` 函数
    - 接收 YAML 内容和输出路径
    - 将内容写入 docker-compose.yml 文件
    - 处理文件写入错误
    - _需求: 1.1, 1.2, 1.3, 1.4, 1.5_

  - [ ] 5.2 创建 `write_config_json()` 函数
    - 接收 JSON 内容和输出路径
    - 将内容写入 config.json 文件
    - 使用适当的缩进格式化 JSON（indent=2）
    - 处理文件写入错误
    - _需求: 2.1, 2.2, 2.3, 2.4, 2.5, 2.6, 2.7_

  - [ ]* 5.3 为文件格式有效性编写属性测试
    - **属性 9: JSON 格式有效性**
    - **属性 10: 相对路径使用**
    - **验证需求: 2.7, 5.4**

- [ ] 6. 检查点 - 确保配置生成功能完整
  - 确保所有测试通过，如有问题请询问用户

- [ ] 7. 创建部署指南生成器
  - [ ] 7.1 创建 `generate_deployment_guide()` 函数
    - 生成 Markdown 格式的部署指南
    - 包含前置条件检查（Docker 和 Docker Compose 安装）
    - 包含创建项目目录的命令（mkdir -p ~/terminal-website）
    - 包含生成配置文件的说明（运行 Python 脚本）
    - 包含启动容器的命令（docker-compose up -d）
    - 包含验证容器状态的命令（docker-compose ps）
    - 包含查看日志的命令（docker-compose logs -f）
    - 包含停止和重启容器的命令
    - 包含访问 URL 说明（http://<服务器IP>:3000）
    - 包含阿里云安全组配置说明（开放端口 3000）
    - _需求: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6, 5.1, 6.3, 6.4, 6.5, 7.2, 7.3_

  - [ ] 7.2 添加故障排查部分
    - 添加常见错误和解决方案
    - 包含端口占用检查命令
    - 包含权限问题解决方案
    - 包含配置文件验证命令
    - _需求: 错误处理部分_

  - [ ] 7.3 创建 `write_deployment_guide()` 函数
    - 将部署指南写入 DEPLOYMENT.md 文件
    - 处理文件写入错误
    - _需求: 3.1, 3.2, 3.3, 3.4, 3.5, 3.6_

- [ ] 8. 创建主程序入口
  - [ ] 8.1 实现 `main()` 函数
    - 解析命令行参数（可选：输出目录）
    - 调用所有生成函数
    - 将生成的文件写入指定目录
    - 打印成功消息和下一步说明
    - _需求: 所有需求_

  - [ ] 8.2 添加命令行界面
    - 使用 argparse 添加命令行参数支持
    - 支持 --output-dir 参数指定输出目录（默认为当前目录）
    - 支持 --help 显示使用说明
    - _需求: 3.1, 5.1_

- [ ] 9. 创建快速部署脚本
  - [ ] 9.1 创建 `deploy.sh` Bash 脚本
    - 检查 Python 3 是否安装
    - 运行 generator.py 生成配置文件
    - 提示用户编辑 config.json 中的占位符（GitHub 用户名和 Email）
    - 提供一键启动容器的选项
    - _需求: 3.7, 3.8_

  - [ ] 9.2 添加脚本执行权限说明
    - 在部署指南中说明如何给脚本添加执行权限
    - 提供命令：chmod +x deploy.sh
    - _需求: 3.8_

- [ ] 10. 创建 README 文档
  - [ ] 10.1 编写项目 README.md
    - 项目简介和功能说明
    - 快速开始指南
    - 使用 Python 脚本生成配置的说明
    - 使用 Bash 脚本一键部署的说明
    - 自定义配置的说明
    - 链接到详细的 DEPLOYMENT.md
    - _需求: 3.1, 3.2, 3.3, 3.4_

  - [ ] 10.2 添加示例截图或输出
    - 添加终端网站的预期效果说明
    - 添加成功部署后的示例输出
    - _需求: 3.6_

- [ ] 11. 最终检查点 - 完整性验证
  - 确保所有文件生成正确
  - 确保所有测试通过
  - 验证部署指南的命令可以直接复制粘贴使用
  - 如有问题请询问用户

## 注意事项

- 标记为 `*` 的任务是可选的，可以跳过以加快 MVP 开发
- 每个任务都引用了具体的需求以确保可追溯性
- 检查点确保增量验证
- 属性测试验证通用正确性属性
- 单元测试验证特定示例和边缘情况
